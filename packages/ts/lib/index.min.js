!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.editimagejs=t():e.editimagejs=t()}(window,function(){return function(r){var n={};function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=r,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(i){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},t=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.forEach(function(e){var t,r,n;t=i,n=a[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return i}r.r(t);var n,L=(function(e){var t,i,s,f,h,d,a;"undefined"!=typeof window&&(t=window,i=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,s=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),f=s&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),h=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,d=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,a=(s||h)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,r,n,i,a,o,l,u,c;if(!(t=e.match(d)))throw new Error("invalid data URI");for(r=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),n=!!t[4],i=e.slice(t[0].length),a=n?atob(i):decodeURIComponent(i),o=new ArrayBuffer(a.length),l=new Uint8Array(o),u=0;u<a.length;u+=1)l[u]=a.charCodeAt(u);return s?new Blob([f?l:o],{type:r}):((c=new h).append(o),c.getBlob(r))},t.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(e,t,r){var n=this;setTimeout(function(){r&&i.toDataURL&&a?e(a(n.toDataURL(t,r))):e(n.mozGetAsFile("blob",t))})}:i.toDataURL&&a&&(i.toBlob=function(e,t,r){var n=this;setTimeout(function(){e(a(n.toDataURL(t,r)))})})),e.exports?e.exports=a:t.dataURLtoBlob=a)}(n={exports:{}},n.exports),n.exports),o={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,quality:.8,mimeType:"auto",convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},l="undefined"!=typeof window?window:{},c=Array.prototype.slice;var s=/^image\/.+$/;function P(e){return s.test(e)}var b=String.fromCharCode;var f=l.btoa;function h(e){var t,r=new DataView(e);try{var n,i,a;if(255===r.getUint8(0)&&216===r.getUint8(1))for(var o=r.byteLength,l=2;l+1<o;){if(255===r.getUint8(l)&&225===r.getUint8(l+1)){i=l;break}l+=1}if(i){var u=i+10;if("Exif"===function(e,t,r){var n,i="";for(r+=t,n=t;n<r;n+=1)i+=b(e.getUint8(n));return i}(r,i+4,4)){var c=r.getUint16(u);if(((n=18761===c)||19789===c)&&42===r.getUint16(u+2,n)){var s=r.getUint32(u+4,n);8<=s&&(a=u+s)}}}if(a){var f,h,d=r.getUint16(a,n);for(h=0;h<d;h+=1)if(f=a+12*h+2,274===r.getUint16(f,n)){f+=8,t=r.getUint16(f,n),r.setUint16(f,1,n);break}}}catch(e){t=1}return t}var d=/\.\d*(?:0|9){12}\d*$/;function D(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e11;return d.test(e)?Math.round(e*t)/t:e}var p=l.ArrayBuffer,m=l.FileReader,y=l.URL||l.webkitURL,v=/\.\w+$/,g=l.Compressor,w=function(){function r(e,t){!
/*!
 * Compressor.js v1.0.5
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2019-01-23T10:53:08.724Z
 */
function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.file=e,this.image=new Image,this.options=a({},o,t),this.aborted=!1,this.result=null,this.init()}var e,t,n;return e=r,n=[{key:"noConflict",value:function(){return window.Compressor=g,r}},{key:"setDefaults",value:function(e){u(o,e)}}],(t=[{key:"init",value:function(){var i=this,a=this.file,e=this.options;if(t=a,"undefined"!=typeof Blob&&(t instanceof Blob||"[object Blob]"===Object.prototype.toString.call(t))){var t,o=a.type;if(P(o))if(y&&m)if(p||(e.checkOrientation=!1),y&&!e.checkOrientation)this.load({url:y.createObjectURL(a)});else{var r=new m,l=e.checkOrientation&&"image/jpeg"===o;(this.reader=r).onload=function(e){var t=e.target.result,r={};if(l){var n=h(t);1<n||!y?(r.url=function(e,t){for(var r,n=[],i=new Uint8Array(e);0<i.length;)n.push(b.apply(null,(r=i.subarray(0,8192),Array.from?Array.from(r):c.call(r)))),i=i.subarray(8192);return"data:".concat(t,";base64,").concat(f(n.join("")))}(t,o),1<n&&u(r,function(e){var t=0,r=1,n=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:n}}(n))):r.url=y.createObjectURL(a)}else r.url=t;i.load(r)},r.onabort=function(){i.fail(new Error("Aborted to read the image with FileReader."))},r.onerror=function(){i.fail(new Error("Failed to read the image with FileReader."))},r.onloadend=function(){i.reader=null},l?r.readAsArrayBuffer(a):r.readAsDataURL(a)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var t=this,r=this.file,n=this.image;n.onload=function(){t.draw(a({},e,{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){t.fail(new Error("Aborted to load the image."))},n.onerror=function(){t.fail(new Error("Failed to load the image."))},n.alt=r.name,n.src=e.url}},{key:"draw",value:function(e){var t=this,r=e.naturalWidth,n=e.naturalHeight,i=e.rotate,a=void 0===i?0:i,o=e.scaleX,l=void 0===o?1:o,u=e.scaleY,c=void 0===u?1:u,s=this.file,f=this.image,h=this.options,d=document.createElement("canvas"),b=d.getContext("2d"),p=r/n,m=Math.abs(a)%180==90,y=Math.max(h.maxWidth,0)||1/0,v=Math.max(h.maxHeight,0)||1/0,g=Math.max(h.minWidth,0)||0,w=Math.max(h.minHeight,0)||0,x=Math.max(h.width,0)||r,j=Math.max(h.height,0)||n;if(m){var U=[v,y];y=U[0],v=U[1];var O=[w,g];g=O[0],w=O[1];var k=[j,x];x=k[0],j=k[1]}y<1/0&&v<1/0?y<v*p?v=y/p:y=v*p:y<1/0?v=y/p:v<1/0&&(y=v*p),0<g&&0<w?g<w*p?w=g/p:g=w*p:0<g?w=g/p:0<w&&(g=w*p),x<j*p?j=x/p:x=j*p;var B=-(x=Math.floor(D(Math.min(Math.max(x,g),y))))/2,M=-(j=Math.floor(D(Math.min(Math.max(j,w),v))))/2,T=x,A=j;if(m){var R=[j,x];x=R[0],j=R[1]}d.width=x,d.height=j,P(h.mimeType)||(h.mimeType=s.type);var S="transparent";if(s.size>h.convertSize&&"image/png"===h.mimeType&&(S="#fff",h.mimeType="image/jpeg"),b.fillStyle=S,b.fillRect(0,0,x,j),h.beforeDraw&&h.beforeDraw.call(this,b,d),!this.aborted&&(b.save(),b.translate(x/2,j/2),b.rotate(a*Math.PI/180),b.scale(l,c),b.drawImage(f,B,M,T,A),b.restore(),h.drew&&h.drew.call(this,b,d),!this.aborted)){var E=function(e){t.aborted||t.done({naturalWidth:r,naturalHeight:n,result:e})};d.toBlob?d.toBlob(E,h.mimeType,h.quality):E(L(d.toDataURL(h.mimeType,h.quality)))}}},{key:"done",value:function(e){var t,r,n=e.naturalWidth,i=e.naturalHeight,a=e.result,o=this.file,l=this.image,u=this.options;if(y&&!u.checkOrientation&&y.revokeObjectURL(l.src),a)if(u.strict&&a.size>o.size&&u.mimeType===o.type&&!(u.width>n||u.height>i||u.minWidth>n||u.minHeight>i))a=o;else{var c=new Date;a.lastModified=c.getTime(),a.lastModifiedDate=c,a.name=o.name,a.name&&a.type!==o.type&&(a.name=a.name.replace(v,(t=a.type,"jpeg"===(r=P(t)?t.substr(6):"")&&(r="jpg"),".".concat(r))))}else a=o;this.result=a,u.success&&u.success.call(this,a)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}])&&i(e.prototype,t),n&&i(e,n),r}(),x=function(){return(x=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(a,o,l,u){return new(l||(l=Promise))(function(e,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new l(function(e){e(t.value)}).then(r,n)}i((u=u.apply(a,o||[])).next())})},U=function(r,n){var i,a,o,e,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,a&&(o=2&t[0]?a.return:t[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,t[1])).done)return o;switch(a=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(o=0<(o=l.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){l.label=t[1];break}if(6===t[0]&&l.label<o[1]){l.label=o[1],o=t;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(t);break}o[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(r,l)}catch(e){t=[6,e],a=0}finally{i=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},O={strict:!0,checkOrientation:!0,maxWidth:void 0,maxHeight:void 0,minWidth:0,minHeight:0,width:void 0,height:void 0,quality:.7,mimeType:"",convertSize:2e5};function k(n,i){return void 0===i&&(i=O),j(this,void 0,Promise,function(){return U(this,function(e){return[2,new Promise(function(r,t){return new w(n,x({},i,{success:function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(e){e.target&&r(e.target.result)}},error:function(e){t(e)}}))})]})})}r.d(t,"imageCompress",function(){return k})}])});